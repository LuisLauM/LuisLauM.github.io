{
  "hash": "383b2243f9dcfb39918a5c40efc44151",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Drawing timeline (Gantt) diagrams in R\"\ndescription: |\n  A quick tutorial to draw time line diagrams using R and googleVis | Un tutorial rápido para crear diagramas de líneas de tiempo usando R y googleVis\ndate: 2024-12-19\nimage: banner.jpg\nabout: \n  template: marquee\n  image-shape: rectangle\nkeywords: [\"timeline\", \"timelines\", \"Gantt diagram\", \"R\", \"googleVis\", \"tutorial\"]\ntags: [\"timeline\", \"timelines\", \"Gantt diagram\", \"R\", \"googleVis\"]\ncategories: [\"R\", \"tutorial\"]\ndraft: false\nengine: knitr\n---\n\n\nImage credits: Jussara Romão at [Unplash](https://unsplash.com/photos/landscape-photography-of-orange-lights-3cM5Vw3UjaY?utm_content=creditShareLink&utm_medium=referral&utm_source=unsplash)\n\n# \\[EN\\] Drawing timeline diagrams in R\n\nA Gantt (timeline) diagram is a visual project management tool that organizes tasks on a timeline, showing their duration, start and end using horizontal bars. It is especially useful in writing research projects because it allows you to clearly plan and visualize key stages, such as literature review, data collection, analysis and writing, ensuring that deadlines are met. In addition, it helps to coordinate efforts among team members, identify possible overlaps or bottlenecks, and provide a reference for monitoring project progress.\n\nWhile they are easy to understand, they are not necessarily easy to draw, especially if you want to maintain the proportions between periods and the length of each line:\n\n1.  We will start by building a table in MS Excel with the following columns: `n`, `group`, `activity`, `start` and `end`. The `n` column will be used to define the difference (or similarity) of colors between each element (line):\n\n    ![](images/clipboard-3749268084.png)\n\n    The script will generate a graph for each sheet in the file.\n\n2.  Now we will move on to the script, where the first thing we will do is to make sure we have installed the [googleVis](https://cran.r-project.org/package=googleVis), [readxl](https://cran.r-project.org/package=readxl) and [dplyr](https://cran.r-project.org/package=dplyr) packages:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Loading the packages\nrequire(googleVis)\nrequire(readxl)\nrequire(dplyr)\n\n# Read table with information of your activities\ninputFile <- \"input_table.xlsx\"\n\n# Define the colors for each group (# of colors = # of groups) in HEX code\ncols <- c(\"mediumaquamarine\", \"darkgoldenrod1\", \"gray40\", \n          \"darkslategray1\", \"darkseagreen1\", \"lightpink\", \"lightpink\", \"mediumpurple2\") |> \n  \n  gplots::col2hex() |> \n  \n  gsub(pattern = \"#\", replacement = \"\") |> \n  \n  tolower()\n\n# Size of diagram\nwidthOut <- 1800\nheightOut <- 900\n\n# Sizes of text \nsizeTextGroups <- 18\nsizeTextActivities <- 16\n\n# Some text for seting the ID of the figure\nidHTML <- \"PhDTimeline_WLauM\"\n\n# Extracting the name of sheets of your Excel file\nallSheets <- excel_sheets(path = inputFile)\n\n# Run a loop along the sheets\nfor(i in seq_along(allSheets)){\n  \n  # Read the sheet\n  inputData <- read_excel(path = inputFile, sheet = allSheets[i])\n  \n  # Get the groups\n  nGroups <- unique(inputData$n)\n  \n  # Create a string that will be used for the gvisTimeline as colors for groups\n  tempCols <- cols[nGroups] |>\n    \n    sprintf(fmt = \"'%s'\") |>\n    \n    paste(collapse = \",\") |> \n    \n    sprintf(fmt = \"[%s]\") \n  \n  # Take the read table...\n  inputData |> \n    \n    rename_with(.fn = \\(x) tolower(x) |> gsub(pattern = \"[[:blank:]]\", replacement = \"\")) |> \n    \n    rename(Group = group, Activity = activity) |> \n    \n    # ...add little chanegs: making some changes to the group labels, \n    #                        converting dates to format Date\n    mutate(group = paste0(Group, \": \"),\n           start = as.Date(x = start),\n           end = as.Date(x = end)) |> \n    \n    # Run the main function\n    gvisTimeline(rowlabel = \"Group\",\n                 barlabel = \"Activity\",\n                 start = \"start\", \n                 end = \"end\",\n                 options = list(timeline = sprintf(\"{%s}\", \n                                                   paste(\"groupByRowLabel:false\",\n                                                         \"colorByRowLabel:true\",\n                                                         sprintf(\"rowLabelStyle:{fontSize: %s}\", \n                                                                 sizeTextGroups),\n                                                         sprintf(\"barLabelStyle:{fontSize: %s}\", \n                                                                 sizeTextActivities),\n                                                         sep = \",\")),\n                                alternatingRowStyle = FALSE,\n                                backgroundColor = 'white', \n                                height = heightOut,\n                                width = widthOut,\n                                colors = tempCols), \n                 chartid = paste(idHTML, i, sep = \"_\")) |> \n    \n    # Plot (show) the time line\n    plot()\n}\n```\n:::\n\n\n**GoogleVis** generates files in HTML format that will open immediately in our default browser (each sheet of our input file will generate an HTML that will open in a separate tab). From there we can take screenshots (or snippets) to save them as image files or paste them directly into the document we are working on.\n\nFor our example, two tabs were generated with the expected diagrams:\n\n![](images/clipboard-854640556.png)\n\n![](images/clipboard-2878228574.png)\n\n---\n\n# \\[ES\\] Dibujando diagramas de línea de tiempo en R\n\nUn diagrama (de líneas de tiempo) de Gantt es una herramienta visual de gestión de proyectos que organiza las tareas en una línea de tiempo, mostrando su duración, inicio y fin mediante barras horizontales. Es especialmente útil en la redacción de proyectos de investigación porque permite planificar y visualizar de manera clara las etapas clave, como la revisión de literatura, recolección de datos, análisis y redacción, asegurando que se cumplan los plazos establecidos. Además, ayuda a coordinar esfuerzos entre los integrantes del equipo, identificar posibles solapamientos o cuellos de botella y proporcionar una referencia para monitorear el progreso del proyecto.\n\nSi bien son fáciles de entender, no necesariamente lo son de dibujar, sobre todo si se desea mantener las proporciones entre los períodos y el largo de cada línea:\n\n1.  Comenzaremos construyendo una tabla en MS Excel con las siguientes columnas: `n`, `group`, `activity`, `start` y `end`. La columna `n` servirá para definir la diferencia (o similaridad) de colores entre cada elemento (línea):\n\n    ![](images/clipboard-3749268084.png)\n\n    El script generará un gráfico por cada hoja del archivo.\n\n2.  Ahora pasaremos al script, en donde lo primero que haremos será asegurarnos de tener instalados los paquetes [googleVis](https://cran.r-project.org/package=googleVis), [readxl](https://cran.r-project.org/package=readxl) y [dplyr](https://cran.r-project.org/package=dplyr):\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Loading the packages\nrequire(googleVis)\nrequire(readxl)\nrequire(dplyr)\n\n# Read table with information of your activities\ninputFile <- \"input_table.xlsx\"\n\n# Define the colors for each group (# of colors = # of groups) in HEX code\ncols <- c(\"mediumaquamarine\", \"darkgoldenrod1\", \"gray40\", \n          \"darkslategray1\", \"darkseagreen1\", \"lightpink\", \"lightpink\", \"mediumpurple2\") |> \n  \n  gplots::col2hex() |> \n  \n  gsub(pattern = \"#\", replacement = \"\") |> \n  \n  tolower()\n\n# Size of diagram\nwidthOut <- 1800\nheightOut <- 900\n\n# Sizes of text \nsizeTextGroups <- 18\nsizeTextActivities <- 16\n\n# Some text for seting the ID of the figure\nidHTML <- \"PhDTimeline_WLauM\"\n\n# Extracting the name of sheets of your Excel file\nallSheets <- excel_sheets(path = inputFile)\n\n# Run a loop along the sheets\nfor(i in seq_along(allSheets)){\n  \n  # Read the sheet\n  inputData <- read_excel(path = inputFile, sheet = allSheets[i])\n  \n  # Get the groups\n  nGroups <- unique(inputData$n)\n  \n  # Create a string that will be used for the gvisTimeline as colors for groups\n  tempCols <- cols[nGroups] |>\n    \n    sprintf(fmt = \"'%s'\") |>\n    \n    paste(collapse = \",\") |> \n    \n    sprintf(fmt = \"[%s]\") \n  \n  # Take the read table...\n  inputData |> \n    \n    rename_with(.fn = \\(x) tolower(x) |> gsub(pattern = \"[[:blank:]]\", replacement = \"\")) |> \n    \n    rename(Group = group, Activity = activity) |> \n    \n    # ...add little chanegs: making some changes to the group labels, \n    #                        converting dates to format Date\n    mutate(group = paste0(Group, \": \"),\n           start = as.Date(x = start),\n           end = as.Date(x = end)) |> \n    \n    # Run the main function\n    gvisTimeline(rowlabel = \"Group\",\n                 barlabel = \"Activity\",\n                 start = \"start\", \n                 end = \"end\",\n                 options = list(timeline = sprintf(\"{%s}\", \n                                                   paste(\"groupByRowLabel:false\",\n                                                         \"colorByRowLabel:true\",\n                                                         sprintf(\"rowLabelStyle:{fontSize: %s}\", \n                                                                 sizeTextGroups),\n                                                         sprintf(\"barLabelStyle:{fontSize: %s}\", \n                                                                 sizeTextActivities),\n                                                         sep = \",\")),\n                                alternatingRowStyle = FALSE,\n                                backgroundColor = 'white', \n                                height = heightOut,\n                                width = widthOut,\n                                colors = tempCols), \n                 chartid = paste(idHTML, i, sep = \"_\")) |> \n    \n    # Plot (show) the time line\n    plot()\n}\n```\n:::\n\n\n**googleVis** genera archivos en formato HTML que se abrirán inmediatamente en nuestro navegador predeterminado (cada hoja de nuestro archivo de entrada generará un HTML que se abrirá en una pestaña independiente). A partir de ahí podremos realizar capturas (o recortes) de pantalla para guardarlos como archivos de imagen o pegarlos directamente sobre el documento en el que estemos trabajando.\n\nPara nuestro ejemplo, se generaron dos pestañas con los diagramas esperados:\n\n![](images/clipboard-854640556.png)\n\n![](images/clipboard-2878228574.png)\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}